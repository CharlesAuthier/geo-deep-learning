name: Docker Image CI

on: [push, pull_request]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Build the Docker image
      run: sudo docker build -t gdl -f Dockerfile .
    - name: test GDL's 4 major modes
      run: |
        for z in tests/data/*.zip; do unzip "$z" -d tests/data; done
        coverage run -m pytest --log-cli-level=INFO --capture=tee-sys
        coverage report -m --sort=Cover
